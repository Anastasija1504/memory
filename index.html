<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <title>Memory ‚Äì —Ç—Ä–µ–Ω—É–≤–∞–ª—å–Ω–∏–π —Ç–µ—Å—Ç</title>
    <style>
        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            margin: 0;
            background: #f5f6fa;
            color: #222;
        }

        .top-bar {
            background: #2f3640;
            color: #fff;
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 14px;
        }

        .container {
            max-width: 900px;
            margin: 30px auto;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.08);
            padding: 30px 40px 40px;
        }

        .tag {
            display: inline-block;
            margin-right: 8px;
            margin-top: 4px;
            padding: 3px 8px;
            border-radius: 999px;
            background: #e1f0ff;
            color: #1e6fd9;
            font-size: 12px;
        }

        input {
            padding: 8px 10px;
            border-radius: 4px;
            border: 1px solid #ccc;
            font-size: 14px;
            min-width: 260px;
            margin-top: 5px;
        }

        input.error {
            border: 2px solid #ff3b3b;
            background: #ffe6e6;
        }

        .error-text {
            color: #d40000;
            font-size: 13px;
            display: none;
            margin-top: 4px;
        }

        .primary-btn {
            background: #0052cc;
            color: #fff;
            border: none;
            border-radius: 4px;
            padding: 12px 20px;
            cursor: pointer;
            margin-top: 25px;
        }

        .hidden { display: none; }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 10px;
            max-width: 420px;
            margin: 0 auto;
        }

        .card {
            width: 80px;
            height: 80px;
            background: #f0f0f0;
            font-size: 32px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: 0.15s;
        }

        .card.open { background: #dcdde1; transform: scale(1.05); }
        .card.matched { background: #4cd137; color: white; }

        #result-screen {
            text-align: center;
            animation: fadeIn .6s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to   { opacity: 1; transform: translateY(0); }
        }
    </style>

    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
</head>
<body>

<div class="top-bar">
    <strong>–ú–µ–º–æ—Ä—ñ</strong>
    <div>
        –†—ñ–≤–µ–Ω—å: <span id="top-level">0</span> / 6
        &nbsp; | &nbsp;
        –ß–∞—Å: <span id="top-time">00:00</span>
    </div>
</div>

<!-- üü¶ –°–¢–ê–†–¢–û–í–ò–ô –ï–ö–†–ê–ù -->
<div class="container" id="start-screen">
    <h1>Memory ‚Äì —Ç—Ä–µ–Ω—É–≤–∞–ª—å–Ω–∏–π —Ç–µ—Å—Ç</h1>

    <p>
        <span class="tag">–ö–æ—Ä–æ—Ç–∫–æ—á–∞—Å–Ω–∞ –ø–∞–º‚Äô—è—Ç—å</span>
        <span class="tag">–°–ø–æ—Å—Ç–µ—Ä–µ–∂–ª–∏–≤—ñ—Å—Ç—å</span>
        <span class="tag">–û–±—Ä–∞–∑–Ω–µ –º–∏—Å–ª–µ–Ω–Ω—è</span>
    </p>

    <label>–Ü–º‚Äô—è —É—á–∞—Å–Ω–∏–∫–∞:</label><br>
    <input id="player-name" type="text" placeholder="–í–≤–µ–¥—ñ—Ç—å —ñ–º‚Äô—è">

    <br><br>

    <label>–ï–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞ –ø–æ—à—Ç–∞ (–æ–±–æ–≤‚Äô—è–∑–∫–æ–≤–æ):</label><br>
    <input id="player-email" type="email" placeholder="email@example.com">
    <div id="email-error" class="error-text">–ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω—É –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –ø–æ—à—Ç—É.</div>

    <button class="primary-btn" id="start-btn">–ü–æ—á–∞—Ç–∏ —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è</button>
</div>

<!-- üü¶ –ï–ö–†–ê–ù –ì–†–ò -->
<div class="container hidden" id="game-screen">
    <h2>–ó–Ω–∞–π–¥—ñ—Ç—å –ø–∞—Ä–∏ –∫–∞—Ä—Ç–æ–∫</h2>

    <p>–†—ñ–≤–µ–Ω—å: <span id="level-label">1</span> / 6<br>
       –ü–∞—Ä –∑–Ω–∞–π–¥–µ–Ω–æ: <span id="matches-label">0</span><br>
       –°–ø—Ä–æ–±: <span id="moves-label">0</span>
    </p>

    <div class="grid" id="grid"></div>
</div>

<!-- üü¶ –†–ï–ó–£–õ–¨–¢–ê–¢ -->
<div class="container hidden" id="result-screen">
    <h2>üéâ –í—ñ—Ç–∞—î–º–æ! –í–∏ –ø—Ä–æ–π—à–ª–∏ –≤—Å—ñ —Ä—ñ–≤–Ω—ñ!</h2>

    <p id="res-name"></p>
    <p id="res-email"></p>
    <p id="res-time"></p>
    <p id="res-moves"></p>
</div>

<script>
/* -------------------- –ù–ê–õ–ê–®–¢–£–í–ê–ù–ù–Ø -------------------- */
const TOTAL_LEVELS = 6;
const icons = ["‚úàÔ∏è","‚òÇÔ∏è","üöÄ","üòÄ","üê±","‚≠ê","‚öΩ","üçé","üéß","üìö","üöó","üåà","üé≤","üèÄ","üéÅ"];

/* -------------------- –ó–ú–Ü–ù–ù–Ü –ì–†–ò -------------------- */
let nameUser = "", emailUser = "";
let level = 1, moves = 0, matched = 0;
let cards = [], openCards = [];
let totalSeconds = 0, timer = null;

/* -------------------- DOM -------------------- */
const startScreen = document.getElementById("start-screen");
const gameScreen  = document.getElementById("game-screen");
const resultScreen= document.getElementById("result-screen");

const grid         = document.getElementById("grid");
const levelLabel   = document.getElementById("level-label");
const matchesLabel = document.getElementById("matches-label");
const movesLabel   = document.getElementById("moves-label");
const topLevel     = document.getElementById("top-level");
const topTime      = document.getElementById("top-time");

const emailField = document.getElementById("player-email");
const emailError = document.getElementById("email-error");

/* -------------------- –°–¢–ê–†–¢ -------------------- */
document.getElementById("start-btn").onclick = () => {
    const email = emailField.value.trim();

    if (!email || !email.includes("@") || !email.includes(".")) {
        emailField.classList.add("error");
        emailError.style.display = "block";
        return;
    }

    emailField.classList.remove("error");
    emailError.style.display = "none";

    nameUser  = document.getElementById("player-name").value.trim() || "‚Äî";
    emailUser = email;

    startScreen.classList.add("hidden");
    gameScreen.classList.remove("hidden");

    startTimer();
    loadLevel();
};

/* -------------------- –¢–ê–ô–ú–ï–† -------------------- */
function startTimer() {
    timer = setInterval(() => {
        totalSeconds++;
        topTime.textContent = formatTime(totalSeconds);
    }, 1000);
}

function stopTimer() { clearInterval(timer); }

function formatTime(s) {
    const m = Math.floor(s / 60);
    return `${m<10?"0":""}${m}:${(s%60)<10?"0":""}${s%60}`;
}

/* -------------------- –†–Ü–í–ù–Ü -------------------- */
function loadLevel() {
    const pairs = 4 + (level - 1) * 2; // 8, 12, 16...

    cards = shuffle([...icons.slice(0, pairs), ...icons.slice(0, pairs)]);
    matched = 0;
    openCards = [];
    moves = 0;

    levelLabel.textContent = level;
    matchesLabel.textContent = `${matched} / ${pairs}`;
    movesLabel.textContent = moves;
    topLevel.textContent = level;

    grid.innerHTML = "";
    cards.forEach((icon, idx) => {
        const c = document.createElement("div");
        c.className = "card";
        c.dataset.index = idx;
        c.onclick = () => reveal(idx);
        grid.appendChild(c);
    });
}

function shuffle(arr) {
    for (let i=arr.length-1; i>0; i--) {
        const j = Math.floor(Math.random()* (i+1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
    }
    return arr;
}

/* -------------------- –ì–†–ê -------------------- */
function reveal(i) {
    const elements = document.querySelectorAll(".card");
    const card = elements[i];

    if (card.classList.contains("matched") || card.classList.contains("open")) return;
    if (openCards.length === 2) return;

    card.classList.add("open");
    card.textContent = cards[i];
    openCards.push({i, card, value: cards[i]});

    if (openCards.length === 2) checkMatch();
}

function checkMatch() {
    moves++;
    movesLabel.textContent = moves;

    const [a, b] = openCards;

    if (a.value === b.value) {
        a.card.classList.add("matched");
        b.card.classList.add("matched");
        matched++;

        matchesLabel.textContent = `${matched} / ${cards.length / 2}`;
        openCards = [];

        if (matched === cards.length / 2) setTimeout(nextLevel, 400);

    } else {
        setTimeout(() => {
            a.card.classList.remove("open");
            b.card.classList.remove("open");
            a.card.textContent = "";
            b.card.textContent = "";
            openCards = [];
        }, 500);
    }
}

/* -------------------- –ü–ï–†–ï–•–Ü–î –ú–Ü–ñ –†–Ü–í–ù–Ø–ú–ò -------------------- */
function nextLevel() {
    if (level < TOTAL_LEVELS) {
        level++;
        loadLevel();
    } else {
        finishGame();
    }
}

/* -------------------- –§–Ü–ù–Ü–® -------------------- */
function finishGame() {
    stopTimer();

    gameScreen.classList.add("hidden");
    resultScreen.classList.remove("hidden");

    document.getElementById("res-name").textContent = `–£—á–∞—Å–Ω–∏–∫: ${nameUser}`;
    document.getElementById("res-email").textContent = `Email: ${emailUser}`;
    document.getElementById("res-time").textContent = `–ß–∞—Å: ${formatTime(totalSeconds)}`;
    document.getElementById("res-moves").textContent = `–°–ø—Ä–æ–±: ${moves}`;

    confettiBurst();
    sendToTelegram();
}

/* -------------------- –ö–û–ù–§–ï–¢–Ü -------------------- */
function confettiBurst() {
    const end = Date.now() + 1500;

    (function frame() {
        confetti({
            particleCount: 8,
            spread: 360,
            origin: { x: Math.random(), y: Math.random() - 0.3 }
        });

        if (Date.now() < end) requestAnimationFrame(frame);
    })();
}

/* -------------------- TELEGRAM -------------------- */
function sendToTelegram() {
    const TOKEN = "8517013691:AAElXeP_-V0-XqTIKJ9nFMUkwvXaW3qiziQ";
    const CHAT  = "1350269784";

    const text =
        "üß† –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ Memory-—Ç–µ—Å—Ç—É\n\n" +
        `üë§ –Ü–º‚Äô—è: ${nameUser}\n` +
        `‚úâÔ∏è –ü–æ—à—Ç–∞: ${emailUser}\n` +
        `‚è± –ß–∞—Å: ${formatTime(totalSeconds)} (${totalSeconds} c)\n` +
        `üîÑ –°–ø—Ä–æ–±: ${moves}\n\n` +
        "‚úî –¢–µ—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–æ";

    const url = `https://api.telegram.org/bot${TOKEN}/sendMessage?chat_id=${CHAT}&text=${encodeURIComponent(text)}`;
    new Image().src = url;
}
</script>
</body>
</html>
